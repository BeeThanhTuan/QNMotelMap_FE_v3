<div class="content_wrapper w-full h-[calc(100vh-68px)] flex">
    <div class="filters_area w-[300px] h-full bg-[#f8f7f5] pt-2">
        <form [formGroup]="formFilters" class="filters min-w-[280px] max-w-[280px] mx-auto border rounded-md border-[#e7e7e7] bg-white  ">
            <div class="p-2 text-[16px] text-custom-color-black font-bold border-b border-[#e7e7e7] ">Chọn lọc theo:</div>
            <div class="pt-3 pr-4 pb-2 pl-3 border-b border-[#e7e7e7]">
                <div class="text-[14px] text-custom-color-black font-bold">Dùng các bộ lọc cũ</div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox class="w-5 h-5"  formControlName="motelHasRoomAvailable" (ngModelChange)="handleFilters()"></label>
                    </div>
                    <div class="flex flex-col w-full">
                        <div class="ntt-custom-content-filter">
                            <div>Chỉ hiển thị nhà trọ còn trống</div>
                        </div>
                    </div>
                </div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox class="w-5 h-5"  formControlName="noLiveWithLandlord" (ngModelChange)="handleFilters()"></label>
                    </div>
                    <div class="flex flex-col w-full">
                        <div class="ntt-custom-content-filter">
                            <div>Không chung chủ</div>
                            <span>{{listMotelFiltered.motelsWithoutLandlord.length}}</span>
                        </div>
                    </div>
                </div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox class="w-5 h-5"  formControlName="distanceLess1Km" (ngModelChange)="handleFilters()"></label>
                    </div>
                    <div class="flex flex-col w-full" title="Đại học Quy Nhơn">
                        <div class="ntt-custom-content-filter">
                            <div>Dưới 1 km</div>
                            <span>{{listMotelFiltered.motelsWithin1km.length}}</span>
                        </div>
                        <div class="h-[20px] text-[12px] text-custom-color-black-light">Khoảng cách từ địa chỉ tới trường </div>
                    </div>
                </div> 
            </div>
            <div class="h-[180px] pt-3 pr-4 pb-2 pl-3 border-b border-[#e7e7e7] relative">
                <div class="text-[14px] text-custom-color-black font-bold">Ngân sách của bạn</div>
                <div class="flex justify-between">
                    <div class="text-[14px] mt-1 text-custom-color-black-light font-normal">{{formFilters.get('desiredPrice')?.value | money}} VND</div>
                    <div *ngIf="desiredPriceChanged === true"
                        class="flex justify-center items-center cursor-pointer pointer-events-auto relative z-10"
                        (click)="handleResetDesiredPrice()">
                        <i class='bx bx-reset text-[25px] text-custom-color-black-light hover:text-[#1392ff]' title="Đặt lại giá "></i>
                    </div>
                </div>
                <div id="chart" class="w-[278px]  p-0 relative left-[-20px] top-[-20px]">
                    <apx-chart [series]="chartOptions.series" [chart]="chartOptions.chart"
                                [xaxis]="chartOptions.xaxis" [yaxis]="chartOptions.yaxis"
                                [dataLabels]="chartOptions.dataLabels" [tooltip]="chartOptions.tooltip">
                    </apx-chart>
                  </div>
                <div class="mb-4 relative z-10 top-[-83px]">
                    <input type="range" #price class="w-full " min="500000" max="5000000" step="100000" formControlName="desiredPrice" (ngModelChange)="onChangeDesiredPrice()">
                </div>
            </div>
            <div class="pt-3 pr-4 pb-5 pl-3 ">
                <div class="text-[14px] text-custom-color-black font-bold">Tiện nghi</div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox [nzDisabled]="listMotelFiltered.convenientCounts['Gác lửng'] ? false : true"  class="w-5 h-5"  formControlName="haveMezzanine" (ngModelChange)="handleFilters()"></label>
                    </div>
                    <div class="flex flex-col w-full">
                        <div class="ntt-custom-content-filter">
                            <div>Gác lửng</div>
                            <span>{{listMotelFiltered.convenientCounts['Gác lửng'] ? listMotelFiltered.convenientCounts['Gác lửng'] : 0}}</span>
                        </div>
                    </div>
                </div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox [nzDisabled]="listMotelFiltered.convenientCounts['Vệ sinh riêng'] ? false : true" class="w-5 h-5"  formControlName="haveToilet"  (ngModelChange)="handleFilters()"> </label>
                    </div>
                    <div class="flex flex-col w-full">
                        <div class="ntt-custom-content-filter">
                            <div>Vệ sinh riêng</div>
                            <span>{{listMotelFiltered.convenientCounts['Vệ sinh riêng'] ? listMotelFiltered.convenientCounts['Vệ sinh riêng'] : 0}}</span>
                        </div>
                    </div>
                </div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox [nzDisabled]="listMotelFiltered.convenientCounts['Nơi nấu ăn'] ? false : true"  class="w-5 h-5"  formControlName="havePlaceToCook" (ngModelChange)="handleFilters()"></label>    
                    </div>
                    <div class="flex flex-col w-full">
                        <div class="ntt-custom-content-filter">
                            <div>Nơi nấu ăn</div>
                            <span>{{listMotelFiltered.convenientCounts['Nơi nấu ăn'] ? listMotelFiltered.convenientCounts['Nơi nấu ăn'] : 0}}</span>
                        </div>
                    </div>
                </div>
                <div class="ntt-custom-filter-field">
                    <div>
                       <label nz-checkbox [nzDisabled]="listMotelFiltered.convenientCounts['Điều hoà'] ? false : true" class="w-5 h-5"  formControlName="haveAirConditioner" (ngModelChange)="handleFilters()" ></label>    
                    </div>
                    <div class="flex flex-col w-full">
                        <div class="ntt-custom-content-filter">
                            <div>Điều hoà</div>
                            <span>{{listMotelFiltered.convenientCounts['Điều hoà'] ? listMotelFiltered.convenientCounts['Điều hoà'] : 0}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </form><!--End filters motels-->
    </div>
    <div class="w-[calc(100%-300px)] h-full relative ">
        <ngx-spinner bdColor = "rgba(0, 0, 0, 0.2)" size ="medium" color ="#fff" type ="ball-scale-multiple" [fullScreen] ="false"><p style="color: white" > Đang tải nhà trọ... </p></ngx-spinner>
        <div class="absolute z-10 top-3 left-[30px] ">
            <div class="w-[320px] h-[40px] px-2 flex justify-center items-center bg-white  rounded-[5px] relative z-10 ntt-shadow-input-search focus-within:ntt-shadow-input-search-focus" >
                <i class='bx bx-search text-[20px]'></i>
                <input type="search" spellcheck="false" id="input_address_search"
                autocomplete="off"
                [formControl]="addressSearch"
                (click)="showDropdownSuggestWardCommune = true"
                 class="w-full px-2 focus:outline-none text-[15px] placeholder:text-custom-color-black-light text-custom-color-black-light "
                placeholder="Tìm kiếm trên bản đồ">
            </div>
            <div id="suggest_ward_commune_popup"
                appClickOutsideSuggestWardCommune
                (clickOutsideSuggestWardCommune)="showDropdownSuggestWardCommune = false" 
                *ngIf="showDropdownSuggestWardCommune"
                class="relative w-full bg-white top-[-4px] left-0 rounded-bl-md rounded-br-md  ntt-shadow-input-suggest z-1" >
                <ul class="w-full pt-2">
                    <li *ngFor="let wardCommune of listWardCommune"
                         (click)="handleChooseWardCommune($event)"
                         class="p-2 flex border-b hover:bg-[#f2f2f2] cursor-pointer">
                        <i class='bx bx-map text-[24px] pr-2 text-custom-color-black-light'></i>
                        <p class="w-full text-[15px] text-custom-color-black-light">{{wardCommune}}</p>
                    </li>
                    
                </ul>
            </div> <!-- End dropdown suggest ward/commune -->
        </div>
        <app-view-motel-on-map *ngIf="showPopupMotelOnMap" 
            appClickOutsidePopupMotelOnMap
            (clickOutsidePopupMotelOnMap)="showPopupMotelOnMap = false"
            (showPopupMotelOnMap)="handleHiddenPopupMotelOnMap($event)"
            [idMotel]="idMotel!"
            class="absolute w-[320px] z-10 top-[65px] left-[30px] bg-white p-3 ntt-shadow-input-search rounded-[5px]">
        </app-view-motel-on-map>
        <div id="map" class="w-full h-full relative z-0" ></div>
    </div>
</div>
